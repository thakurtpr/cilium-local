---
apiVersion: v1
kind: ConfigMap
metadata:
  name: test-credentials
  namespace: cilium-test
  labels:
    app: test-credentials
    purpose: authentication-testing
data:
  # Pass-key for authentication
  # This is a test value - replace with your actual pass-key
  PASS_KEY: "test-pass-key-12345"

  # Valid JWT token for testing
  # This is a sample JWT with long expiration
  # Header: {"alg":"HS256","typ":"JWT"}
  # Payload: {"sub":"1234567890","name":"Test User","iat":1516239022,"exp":9999999999}
  VALID_JWT: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTUxNjIzOTAyMiwiZXhwIjo5OTk5OTk5OTk5fQ.4Adcj0PYg1dJ8RXB1xKLrgbWxPHP7w9C8q5HN_8u4u8"

  # Service configuration
  SERVICE_NAME: "test-backend"
  SERVICE_URL: "http://test-backend.cilium-test.svc.cluster.local:8080"

  # Test script helpers
  test-no-auth.sh: |
    #!/bin/sh
    # Test without any authentication headers
    curl -v ${SERVICE_URL}/health

  test-passkey-only.sh: |
    #!/bin/sh
    # Test with pass-key but no JWT
    curl -v -H "pass-key: ${PASS_KEY}" ${SERVICE_URL}/health

  test-full-auth.sh: |
    #!/bin/sh
    # Test with both pass-key and JWT
    curl -v -H "pass-key: ${PASS_KEY}" -H "Authorization: Bearer ${VALID_JWT}" ${SERVICE_URL}/health

  test-post-auth.sh: |
    #!/bin/sh
    # Test POST with full authentication
    curl -v -X POST \
      -H "pass-key: ${PASS_KEY}" \
      -H "Authorization: Bearer ${VALID_JWT}" \
      -H "Content-Type: application/json" \
      -d '{"message":"test"}' \
      ${SERVICE_URL}/echo
---
# Optional: Secret for more sensitive credentials
apiVersion: v1
kind: Secret
metadata:
  name: test-credentials-secret
  namespace: cilium-test
  labels:
    app: test-credentials
    purpose: authentication-testing
type: Opaque
stringData:
  # Store sensitive credentials here instead of ConfigMap if needed
  pass-key: "test-pass-key-12345"
  jwt-secret: "test-secret"
  valid-jwt: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IlRlc3QgVXNlciIsImlhdCI6MTUxNjIzOTAyMiwiZXhwIjo5OTk5OTk5OTk5fQ.4Adcj0PYg1dJ8RXB1xKLrgbWxPHP7w9C8q5HN_8u4u8"
